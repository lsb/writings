(this["webpackJsonpredacting-camera"]=this["webpackJsonpredacting-camera"]||[]).push([[0],{13:function(e,t,a){e.exports=a(21)},18:function(e,t,a){},20:function(e,t,a){},21:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(4),c=a.n(i),o=(a(18),a(11)),s=a(1),l=a.n(s),u=a(5),h=a(6),d=a(7),m=a(10),g=a(12),f=a(2),p=(a(20),a(8)),v=a.n(p),b=a(9),k={width:300,height:300},w=["Animal","Archway","Bicyclist","Bridge","Building","Car","CartLuggagePram","Child","Column_Pole","Fence","LaneMkgsDriv","LaneMkgsNonDriv","Misc_Text","MotorcycleScooter","OtherMoving","ParkingBlock","Pedestrian","Road","RoadShoulder","Sidewalk","SignSymbol","Sky","SUVPickupTruck","TrafficCone","TrafficLight","Train","Tree","Truck_Bus","Tunnel","VegetationMisc","Void","Wall"],y=new Map([["no people (for street rallies)",["Bicyclist","Child","MotorcycleScooter","Pedestrian","Truck_Bus","Void"]],["ban cars",["Car","SUVPickupTruck"]],["no sky, no trees",["Sky","Tree","VegetationMisc"]],["nothing uncertain",["Void"]]]),E=new Map(Array.from(y).map((function(e){var t=Object(f.a)(e,2),a=t[0],n=t[1];return[a,new Set(n.map((function(e){return w.indexOf(e)})))]}))),S=new Map(Array.from(E).map((function(e){var t=Object(f.a)(e,2),a=t[0];return[t[1],a]}))),M=function(e){Object(g.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(h.a)(this,a),(n=t.call(this,e)).state={originalPicture:null,processedPicture:null,categories:E.get("no people (for street rallies)"),facingMode:"environment"},n.webcamref=r.a.createRef(),n}return Object(d.a)(a,[{key:"parameterizeEndpoint",value:function(){return"https://redacting-camera.onrender.com/redact?categories="+Array.from(this.state.categories).join(",")}},{key:"componentDidMount",value:function(){this.handleWebcam()}},{key:"handleWebcam",value:function(){var e=this;if(this.webcamref&&this.webcamref.current&&this.webcamref.current.getScreenshot){var t=this.webcamref.current.getScreenshot();null!==t?this.ingestPicture(t):(console.log("screenshot is null, might be still loading"),requestAnimationFrame((function(){return e.handleWebcam()})))}}},{key:"ingestPicture",value:function(){var e=Object(u.a)(l.a.mark((function e(t){var a,n,r,i,c,o,s=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Date.now(),null===this.state.originalPicture&&null===this.state.processedPicture&&this.setState({processedPicture:t}),this.setState({originalPicture:t}),(n=new FormData).append("image",Object(b.a)(t)),r=this.parameterizeEndpoint(),e.next=9,fetch(r,{method:"POST",body:n});case 9:return i=e.sent,e.next=12,i.blob();case 12:c=e.sent,o=Date.now(),requestAnimationFrame((function(){return s.handleWebcam()})),this.setState({processedPicture:URL.createObjectURL(c),millis:o-a});case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"toggleCode",value:function(e){var t=e.checked,a=e.i,n=new Set(this.state.categories);t?n.add(a):n.delete(a),this.setState({categories:n})}},{key:"render",value:function(){var e=this,t=this.state,a=t.processedPicture,n=t.millis,i=t.facingMode,c=t.categories;return r.a.createElement("div",{className:"App"},r.a.createElement("h1",null,"Redacting Camera"),r.a.createElement("h2",null,"via your\xa0",r.a.createElement("select",{id:"facingMode",onChange:function(t){return e.setState({facingMode:t.target.value})},value:this.state.facingMode},r.a.createElement("option",{value:"user"},"selfie"),r.a.createElement("option",{value:"environment"},"photo"),r.a.createElement("option",{value:""})),"\xa0",r.a.createElement("i",null,"webcam!")),r.a.createElement("div",{className:"millis"},n),r.a.createElement("div",null,r.a.createElement("span",{id:"processed"},r.a.createElement("img",{src:a,className:"processedPicture"}))),r.a.createElement("div",{id:"howtoredact"},r.a.createElement("div",null,r.a.createElement("i",null,"how to redact\u203d")),r.a.createElement("div",null,r.a.createElement("select",{id:"categorygroupname",onChange:function(t){return E.has(t.target.value)?e.setState({categories:E.get(t.target.value),justChoseDIY:!1}):e.setState({justChoseDIY:!0})},value:this.state.justChoseDIY||!S.has(this.state.categories)?"diy":S.get(this.state.categories)},Array.from(E.keys()).map((function(e){return r.a.createElement("option",{value:e},e)})),r.a.createElement("option",{value:"diy"},"diy"))),r.a.createElement("div",{id:"codescheckboxes"},w.map((function(t,a){return r.a.createElement("label",null,r.a.createElement("input",{type:"checkbox",checked:c.has(a),onChange:function(t){return e.toggleCode({checked:t.target.checked,i:a})}}),t)})))),r.a.createElement(v.a,{audio:!1,ref:this.webcamref,height:k.height,width:k.width,screenshotFormat:"image/jpeg",videoConstraints:Object(o.a)({},k,{facingMode:i})}))}}]),a}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(M,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[13,1,2]]]);
//# sourceMappingURL=main.3947f957.chunk.js.map